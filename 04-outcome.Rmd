# 实证结果

表\@ref(tab:fntable)为一次南向的基准回归结果，均对应模型\@ref(eq:twdid)。回归（I）、（II）、（III）为模型加入了双向固定效应，但未加入控制变量的情形。从政策干预的回归系数来看，一次南向政策干预对出口占比具有正向影响，对进口占比具有正向影响、对投资占比具有负向影响，但回归系数均不显著；回归（IV）、（V）、（VI）为模型加入了双向固定效应，同时加入控制变量的情形。从政策干预的回归系数来看，政策干预对出口占比具有负向影响，对进口占比具有正向影响、对投资占比具有负向影响，但回归系数亦均不显著。综合来看，一次南向的实施对台湾地区的出口占比、进口占比与投资占比均没有显著的效用。

表\@ref(tab:NSBPtable)为二次南向的基准回归结果，均对应模型(1)。回归（I）、（II）、（III）为模型加入了双向固定效应，但未加入控制变量的情形。从政策干预的回归系数来看，二次南向政策干预对出口占比具有正向影响，对进口占比具有正向影响、对投资占比具有正向影响，但回归系数均不显著。回归（IV）、（V）、（VI）为模型加入了双向固定效应，同时加入控制变量的情形。从政策干预的回归系数来看，政策干预对出口占比具有负向影响，对进口占比具有负向影响、对投资占比具有正向影响，但回归系数亦均不显著。综合来看，二次南向的实施对台湾地区的出口占比、进口占比与投资占比均没有显著的效用。

图\@ref(fig:parallel)为一次南向与二次南向政策基准回归（IV）、（V）、（VI）的平行趋势检验结果，均对应模型\@ref(eq:twevent)，其中左侧为一次南向，右侧为二次南向。从各子图片虚线左侧误差棒的分布看，误差棒均穿过0点，证明一次南向与二次南向的基准回归均已满足平行趋势假定。从虚线右侧的政策滞后效应分析，二次南向实施3年后，对出口占比具有显著的负向影响，体现出一定的滞后效应，这可能由于台湾近二十年来的支柱出口产业为半导体及精密电子商品，而此类出口品在二次南向中所占比重极为有限，无法借由二次南向的实施为出口占比贡献正向影响。

```{r, echo=FALSE, warning=FALSE, results='asis'}

# vcovHC.plm
reg1.1 <- plm(出口占比 ~ 政策干预, data = fn_data, effect = "twoways", model="within", index =  c("State", "Year"))
rse1.1 <- sqrt(diag(vcovHC(reg1.1, cluster = "group")))

reg1.2 <- plm(进口占比 ~ 政策干预, data = fn_data, effect = "twoways", model="within", index =  c("State", "Year"))
rse1.2 <- sqrt(diag(vcovHC(reg1.2, cluster = "group")))

reg1.3 <- plm(投资占比 ~ 政策干预, data = fn_data, effect = "twoways", model="within", index =  c("State", "Year"))
rse1.3 <- sqrt(diag(vcovHC(reg1.3, cluster = "group")))

reg1.4 <- plm(出口占比 ~ 政策干预 + 世贸组织 + 外交持续 + 外交关系 + 亚太经合 + 开放度 + 人口 + 生产总值, data = fn_data, effect = "twoways", model="within", index= c("State", "Year"))
rse1.4 <- sqrt(diag(vcovHC(reg1.4, cluster = "group")))

reg1.5 <- plm(进口占比 ~ 政策干预 + 世贸组织 + 外交持续 + 外交关系 + 亚太经合 + 开放度 + 人口 + 生产总值, data = fn_data, effect = "twoways", model="within", index= c("State", "Year"))
rse1.5 <- sqrt(diag(vcovHC(reg1.5, cluster = "group")))

reg1.6 <- plm(投资占比 ~ 政策干预 + 世贸组织 + 外交持续 + 外交关系 + 亚太经合 + 开放度 + 人口 + 生产总值, data = fn_data, effect = "twoways", model="within", index= c("State", "Year"))
rse1.6 <- sqrt(diag(vcovHC(reg1.6, cluster = "group")))

stargazer(reg1.1, reg1.2, reg1.3, reg1.4, reg1.5, reg1.6, se=list(rse1.1, rse1.2, rse1.3, rse1.4, rse1.5, rse1.6), type = "latex", no.space=TRUE, omit.stat=c("f", "adj.rsq"), label = "tab:fntable", title = "一次南向基准回归", dep.var.caption = "被解释变量", notes.label = "备注：", header=FALSE)
```


```{r, echo=FALSE, warning=FALSE, results='asis'}

reg2.1 <- plm(出口占比 ~ 政策干预, data = NSBP_data, effect = "twoways", model="within", index =  c("State", "Year"))
rse2.1 <- sqrt(diag(vcovHC(reg2.1, cluster = "group")))

reg2.2 <- plm(进口占比 ~ 政策干预, data = NSBP_data, effect = "twoways", model="within", index =  c("State", "Year"))
rse2.2 <- sqrt(diag(vcovHC(reg2.2, cluster = "group")))

reg2.3 <- plm(投资占比 ~ 政策干预, data = NSBP_data, effect = "twoways", model="within", index =  c("State", "Year"))
rse2.3 <- sqrt(diag(vcovHC(reg2.3, cluster = "group")))

reg2.4 <- plm(出口占比 ~ 政策干预 + 世贸组织 + 外交持续 + 外交关系 + 两岸协议 + 自贸协定 + 开放度 + 人口 + 生产总值, data = NSBP_data, effect = "twoways", model="within", index= c("State", "Year"))
rse2.4 <- sqrt(diag(vcovHC(reg2.4, cluster = "group")))

reg2.5 <- plm(进口占比 ~ 政策干预 + 世贸组织 + 外交持续 + 外交关系 + 两岸协议 + 自贸协定 + 开放度 + 人口 + 生产总值, data = NSBP_data, effect = "twoways", model="within", index= c("State", "Year"))
rse2.5 <- sqrt(diag(vcovHC(reg2.5, cluster = "group")))

reg2.6 <- plm(投资占比 ~ 政策干预 + 世贸组织 + 外交持续 + 外交关系 + 两岸协议 + 自贸协定 + 开放度 + 人口 + 生产总值, data = NSBP_data, effect = "twoways", model="within", index= c("State", "Year"))
rse2.6 <- sqrt(diag(vcovHC(reg2.6, cluster = "group")))

stargazer(reg2.1, reg2.2, reg2.3, reg2.4, reg2.5, reg2.6, se=list(rse2.1, rse2.2, rse2.3, rse2.4, rse2.5, rse2.6), type = "latex", no.space=TRUE, omit.stat=c("f", "adj.rsq"), label = "tab:NSBPtable", title = "二次南向基准回归", dep.var.caption = "被解释变量", notes.label = "备注：", header=FALSE)

```

```{r parallel, fig.cap='两次南向平行趋势检验', echo=FALSE, warning=FALSE, fig.height=9}

build_d <- Vectorize(\(state, year) {
  if (state %in% fn_first_state) {
    return(year - 1994)
  } else if (state %in% fn_second_state) {
    return(year - 1997)
  } else {
    return(NA)
  }
})

build_D <- Vectorize(\(state, year) {
  if (state %in% NSBP) {
    return(year - 2016)
  } else {
    return(NA)
  }
})

fn_data <- fn_data |> 
  mutate(fn_d = build_d(State, Year))

fn_data <- purrr::map(na.exclude(unique(fn_data$fn_d)), ~ fn_data |> 
  mutate(!! if_else(. < 0, str_c('d..', -.), str_c('d.', .)) := if_else(. == fn_d, 1, 0), .keep = "none")) |> 
  bind_cols(fn_data, other_table = _) |> 
  mutate(across(starts_with('d.'), ~ if_else(is.na(.), 0, .)))


NSBP_data <- NSBP_data |> 
  mutate(nsbp_d = build_D(State, Year))

NSBP_data <- purrr::map(na.exclude(unique(NSBP_data$nsbp_d)), ~ NSBP_data |>
  mutate(!! if_else(. < 0, str_c('D..', -.), str_c('D.', .)) := if_else(. == nsbp_d, 1, 0), .keep = "none")) |> 
  bind_cols(NSBP_data, other_table = _) |> 
  mutate(across(starts_with('D.'), ~ if_else(is.na(.), 0, .)))

reg3.4 <- plm(出口占比 ~ D..8 + D..7 + D..6 + D..5 + D..4 + D..3 + D..2 + D.0 + D.1 + D.2 + D.3 + 世贸组织 + 外交持续 + 外交关系 + 两岸协议 + 自贸协定 + 开放度 + 人口 + 生产总值, data = NSBP_data, effect = "twoways", model="within", index = c("State", "Year"))

reg3.5 <- plm(进口占比 ~ D..8 + D..7 + D..6 + D..5 + D..4 + D..3 + D..2 + D.0 + D.1 + D.2 + D.3 + 世贸组织 + 外交持续 + 外交关系 + 两岸协议 + 自贸协定 + 开放度 + 人口 + 生产总值, data = NSBP_data, effect = "twoways", model="within", index = c("State", "Year"))

reg3.6 <- plm(投资占比 ~ D..8 + D..7 + D..6 + D..5 + D..4 + D..3 + D..2 + D.0 + D.1 + D.2 + D.3 + 世贸组织 + 外交持续 + 外交关系 + 两岸协议 + 自贸协定 + 开放度+ 人口 + 生产总值, data = NSBP_data, effect = "twoways", model="within", index = c("State", "Year"))

coef3.4 <- as.data.frame(coeftest(reg3.4, vcov.=vcovHC)[1 : 11, 1 :2])
coef3.4$up <- NA
coef3.4$low <- NA
coef3.4$t <- NA
coef3.4$up <- coef3.4$Estimate + 1.96 * coef3.4$`Std. Error`
coef3.4$low <- coef3.4$Estimate - 1.96 * coef3.4$`Std. Error`
coef3.4$t <- c(-8 : -2, 0 : 3)
p4 <- ggplot(coef3.4, aes(t, Estimate)) +
  geom_hline(yintercept = 0, size = 1, color = "white") +
  geom_point() +
  geom_point(aes(x=-1, y=0), colour="red") +
  geom_errorbar(aes(ymin = low, ymax = up), width = 0.2) +
  ylab("系数") +
  xlab("年份") +
  scale_x_continuous(breaks = seq(-8, 3, 1)) +
  geom_vline(xintercept = -1, linetype = "dashed") +
  labs(title = "二次南向", subtitle = "出口") 


coef3.5 <- as.data.frame(coeftest(reg3.5, vcov.=vcovHC)[1 : 11, 1 :2])
coef3.5$up <- NA
coef3.5$low <- NA
coef3.5$t <- NA
coef3.5$up <- coef3.5$Estimate + 1.96 * coef3.5$`Std. Error`
coef3.5$low <- coef3.5$Estimate - 1.96 * coef3.5$`Std. Error`
coef3.5$t <- c(-8 : -2, 0 : 3)
p5 <- ggplot(coef3.5, aes(t, Estimate)) +
  geom_hline(yintercept = 0, size = 1, color = "white") +
  geom_point() +
  geom_point(aes(x=-1, y=0), colour="red") +
  geom_errorbar(aes(ymin = low, ymax = up), width = 0.2) +
  ylab("系数") +
  xlab("年份") +
  scale_x_continuous(breaks = seq(-8, 3, 1)) +
  geom_vline(xintercept = -1, linetype = "dashed") +
  labs(subtitle = "进口") 

coef3.6 <- as.data.frame(coeftest(reg3.6, vcov.=vcovHC)[1 : 11, 1 :2])
coef3.6$up <- NA
coef3.6$low <- NA
coef3.6$t <- NA
coef3.6$up <- coef3.6$Estimate + 1.96 * coef3.6$`Std. Error`
coef3.6$low <- coef3.6$Estimate - 1.96 * coef3.6$`Std. Error`
coef3.6$t <- c(-8 : -2, 0 : 3)
p6 <- ggplot(coef3.6, aes(t, Estimate)) +
  geom_hline(yintercept = 0, size = 1, color = "white") +
  geom_point() +
  geom_point(aes(x=-1, y=0), colour="red") +
  geom_errorbar(aes(ymin = low, ymax = up), width = 0.2) +
  ylab("系数") +
  xlab("年份") +
  scale_x_continuous(breaks = seq(-8, 3, 1)) +
  geom_vline(xintercept = -1, linetype = "dashed") +
  labs(subtitle = "投资") 


reg3.1 <- plm(出口占比 ~ d..7 + d..6 + d..5 + d..4 + d..3 + d..2 + d.0 + d.1 + d.2 + d.3 + d.4 + d.5 + d.6 + d.7 + d.8 + 世贸组织 + 外交持续 + 外交关系 + 亚太经合 + 开放度 + 人口 + 生产总值, data = fn_data, effect = "twoways", model="within", index = c("State", "Year"))

reg3.2 <- plm(进口占比 ~ d..7 + d..6 + d..5 + d..4 + d..3 + d..2 + d.0 + d.1 + d.2 + d.3 + d.4 + d.5 + d.6 + d.7 + d.8 + 世贸组织 + 外交持续 + 外交关系 + 亚太经合 + 开放度 + 人口 + 生产总值, data = fn_data, effect = "twoways", model="within", index = c("State", "Year"))

reg3.3 <- plm(投资占比 ~ d..7 + d..6 + d..5 + d..4 + d..3 + d..2 + d.0 + d.1 + d.2 + d.3 + d.4 + d.5 + d.6 + d.7 + d.8 + 世贸组织 + 外交持续 + 外交关系 + 亚太经合 + 开放度 + 人口 + 生产总值, data = fn_data, effect = "twoways", model="within", index = c("State", "Year"))

coef3.1 <- as.data.frame(coeftest(reg3.1, vcov.=vcovHC)[1 : 15, 1 :2])
coef3.1$up <- NA
coef3.1$low <- NA
coef3.1$t <- NA
coef3.1$up <- coef3.1$Estimate + 1.96 * coef3.1$`Std. Error`
coef3.1$low <- coef3.1$Estimate - 1.96 * coef3.1$`Std. Error`
coef3.1$t <- c(-7 : -2, 0 : 8)
p1 <- ggplot(coef3.1, aes(t, Estimate)) +
  geom_hline(yintercept = 0, size = 1, color = "white") +
  geom_point() +
  geom_point(aes(x=-1, y=0), colour="red") +
  geom_errorbar(aes(ymin = low, ymax = up), width = 0.2) +
  ylab("系数") +
  xlab("年份") +
  scale_x_continuous(breaks = seq(-7, 8, 3)) +
  geom_vline(xintercept = -1, linetype = "dashed") +
  labs(title = "一次南向", subtitle = "出口") 

coef3.2 <- as.data.frame(coeftest(reg3.2, vcov.=vcovHC)[1 : 15, 1 :2])
coef3.2$up <- NA
coef3.2$low <- NA
coef3.2$t <- NA
coef3.2$up <- coef3.2$Estimate + 1.96 * coef3.2$`Std. Error`
coef3.2$low <- coef3.2$Estimate - 1.96 * coef3.2$`Std. Error`
coef3.2$t <- c(-7 : -2, 0 : 8)
p2 <- ggplot(coef3.2, aes(t, Estimate)) +
  geom_hline(yintercept = 0, size = 1, color = "white") +
  geom_point() +
  geom_point(aes(x=-1, y=0), colour="red") +
  geom_errorbar(aes(ymin = low, ymax = up), width = 0.2) +
  ylab("系数") +
  xlab("年份") +
  scale_x_continuous(breaks = seq(-7, 8, 3)) +
  geom_vline(xintercept = -1, linetype = "dashed") +
  labs(subtitle = "进口") 

coef3.3 <- as.data.frame(coeftest(reg3.3, vcov.=vcovHC)[1 : 15, 1 :2])
coef3.3$up <- NA
coef3.3$low <- NA
coef3.3$t <- NA
coef3.3$up <- coef3.3$Estimate + 1.96 * coef3.3$`Std. Error`
coef3.3$low <- coef3.3$Estimate - 1.96 * coef3.3$`Std. Error`
coef3.3$t <- c(-7 : -2, 0 : 8)
p3 <- ggplot(coef3.3, aes(t, Estimate)) +
  geom_hline(yintercept = 0, size = 1, color = "white") +
  geom_point() +
  geom_point(aes(x=-1, y=0), colour="red") +
  geom_errorbar(aes(ymin = low, ymax = up), width = 0.2) +
  ylab("系数") +
  xlab("年份") +
  scale_x_continuous(breaks = seq(-7, 8, 3)) +
  geom_vline(xintercept = -1, linetype = "dashed") +
  labs(subtitle = "投资") 

ggarrange(p1, p4, p2, p5, p3, p6, common.legend = TRUE, nrow = 3, ncol = 2, legend = "top")
```





